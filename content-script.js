
if (window.hasRunContentScriptOnce !== true) {
window.hasRunContentScriptOnce = true; 
     const layout_EngUkr ={ 
        "q":"й",
        "w":"ц",
        "e":"у",
        "r": "к",
        "t": 'е',
        "y": "н",
        "u": "г",
        "i": "ш",
        "o": "щ",
        "p": 'з',
        "[": 'х',
        "]": 'ї',
        "a": 'ф',
        "s": "і",
        "d": 'в',
        "f": "а",
        "g": "п",
        "h": "р",
        "j": "о",
        "k": "л",
        "l": "д",
        ";": "ж",
        "'":"є",
        "z":"я",
        "x":"ч",
        "c":"с",
        "v": "м",
        "b": "и",
        "n": "т",
        "m": "ь",
        ",": "б",
        ".": "ю",
        "/":"." ,
        "`":"'",
        "Q":"Й",
        "W":"Ц",
        "E":"У",
        "R": "К",
        "T": 'Е',
        "Y": "Н",
        "U": "Г",
        "I": "Ш",
        "O": "Щ",
        "P": 'З',
        "{": 'Х',
        "}": 'Ї',
        "A": 'Ф',
        "S": "І",
        "D": 'В',
        "F": "А",
        "G": "П",
        "H": "Р",
        "J": "О",
        "K": "Л",
        "L": "Д",
        ":": "Ж",
        '"':"Є",
        "Z":"Я",
        "X":"Ч",
        "C":"С",
        "V": "М",
        "B": "И",
        "N": "Т",
        "M": "Ь",
        "<": "Б",
        ">": "Ю",
        "?":"," ,
        "~":"₴",
    } 
    const layout_EngGeo ={ 
        "q":"ქ",
        "w":"წ",
        "e":"ე",
        "r": "რ",
        "t": 'ტ',
        "y": "ყ",
        "u": "უ",
        "i": "ი",
        "o": "ო",
        "p": 'პ', 
        "a": 'ა',
        "s": "ს",
        "d": 'დ',
        "f": "ფ",
        "g": "გ",
        "h": "ჰ",
        "j": "ჯ",
        "k": "კ",
        "l": "ლ", 
        "z":"ზ",
        "x":"ხ",
        "c":"ც",
        "v": "ვ",
        "b": "ბ",
        "n": "ნ",
        "m": "მ", 
        "`":"„",
        "Q":"ქ",
        "W":"ჭ",
        "E":"ე",
        "R": "ღ",
        "T": 'თ',
        "Y": "ყ",
        "U": "უ",
        "I": "ი",
        "O": "ო",
        "P": 'პ', 
        "A": 'ა',
        "S": "შ",
        "D": 'დ',
        "F": "ფ",
        "G": "გ",
        "H": "ჰ",
        "J": "ჟ",
        "K": "კ",
        "L": "₾", 
        "Z":"ძ",
        "X":"ხ",
        "C":"ჩ",
        "V": "ვ",
        "B": "ბ",
        "N": "N",
        "M": "მ", 
        "~":"“",
    }
    const layout_EngArm ={ 
        "q":"ք",
        "w":"ո",
        "e":"ե",
        "r": "ռ",
        "t": 'տ',
        "y": "ը",
        "u": "ւ",
        "i": "ի",
        "o": "օ",
        "p": 'պ',
        "[": 'խ',
        "]": 'ծ',
        "\\":"շ", 
        "a": 'ա',
        "s": "ս",
        "d": 'դ',
        "f": "ֆ",
        "g": "գ",
        "h": "հ",
        "j": "յ",
        "k": "կ",
        "l": "լ", 
        "'":"՛",
        "z":"զ",
        "x":"ղ",
        "c":"ց",
        "v": "վ",
        "b": "բ",
        "n": "ն",
        "m": "մ", 
        "Q":"Ք",
        "W":"Ո",
        "E":"Ե",
        "R": "Ռ",
        "T": 'Տ',
        "Y": "Ը",
        "U": "Ւ",
        "I": "Ի",
        "O": "Օ",
        "P": 'Պ',
        "{": 'Խ',
        "}": 'Ծ',
        "A": 'Ա',
        "S": "Ս",
        "D": 'Դ',
        "F": "Ֆ",
        "G": "Գ",
        "H": "Հ",
        "J": "Յ",
        "K": "Կ",
        "L": "Լ", 
        "\\":"Շ", 
        "Z":"Զ",
        "X":"Ղ",
        "C":"Ց",
        "V": "Վ",
        "B": "Բ",
        "N": "Ն",
        "M": "Մ", 
        "?":"՞" ,
        "~":"՜",
        
        "!": "Է",
        "@": "Թ",
        "#": "Փ",
        "$": "Ձ",
        "%":"Ջ" ,
        "^":"Ւ",
        "&": "և",
        "*": "Ր",
        "(": "Չ",
        ")": "Ճ",
        "_":"—" ,
        "+":"Ժ",
    }
    const layout_EngHeb ={ 
        "q":"/",
        "w":"'",
        "e":"ק",
        "r": "ר",
        "t": 'א',
        "y": "ט",
        "u": "ו",
        "i": "ן",
        "o": "ם",
        "p": 'פ',
        "[": ']',
        "]": '[',
        "a": 'ש',
        "s": "ד",
        "d": 'ג',
        "f": "כ",
        "g": "ע",
        "h": "י",
        "j": "ח",
        "k": "ל",
        "l": "ך",
        ";": "ף",
        "'":",",
        "z":"ז",
        "x":"ס",
        "c":"ב",
        "v": "ה",
        "b": "נ",
        "n": "מ",
        "m": "צ",
        ",": "ת",
        ".": "ץ",
        "/":"." ,
        "`":";",
    }
    const layout_EngHin ={ 
        "q":"ौ",
        "w":"ै",
        "e":"ा",
        "r": "ी",
        "t": 'ू',
        "y": "ब",
        "u": "ह",
        "i": "ग",
        "o": "द",
        "p": 'ज',
        "[": 'ड',
        "]": '़',
        "a": 'ो',
        "s": "े",
        "d": '्',
        "f": "ि",
        "g": "ु",
        "h": "प",
        "j": "र",
        "k": "क",
        "l": "त",
        ";": "च",
        "'":"ट",
        "\\":"ॉ", 
        "x":"ं",
        "c":"म",
        "v": "न",
        "b": "व",
        "n": "ल",
        "m": "स", 
        "/":"य" , 
    
        "!": "ऍ",
        "@": "ॅ",
        "#": "्र",
        "$": "र्",
        "%":"ज्ञ" ,
        "^":"त्र",
        "&": "क्ष",
        "*": "श्र",
        "(": "Չ",
        ")": "Ճ",
        "_":"ः" ,
        "+":"ऋ",
    
        "Q":"औ",
        "W":"ऐ",
        "E":"आ",
        "R": "ई",
        "T": 'ऊ',
        "Y": "भ",
        "U": "ङ",
        "I": "घ",
        "O": "ध",
        "P": 'झ',
        "{": 'ढ',
        "}": 'ञ',    
        "\\":"ऑ", 
        "A": 'ओ',
        "S": "ए",
        "D": 'अ',
        "F": "इ",
        "G": "उ",
        "H": "फ",
        "J": "ऱ",
        "K": "ख",
        "L": "थ",
        ":": "छ",
        '"':"ठ", 
        "X":"ँ",
        "C":"ण",
        "V": "न",
        "B": "व",
        "N": "ळ",
        "M": "श",
        "<": "ष",
        ">": "।",
        "?":"य़" , 
    }
    const layout_EngGre ={ 
        "q":";",
        "w":"ς",
        "e":"ε",
        "r": "ρ",
        "t": 'τ',
        "y": "υ",
        "u": "θ",
        "i": "ι",
        "o": "ο",
        "p": 'π', 
        "a": 'α',
        "s": "σ",
        "d": 'δ',
        "f": "φ",
        "g": "γ",
        "h": "η",
        "j": "ξ",
        "k": "κ",
        "l": "λ",
        ";": "΄", 
        "z":"ζ",
        "x":"χ",
        "c":"ψ",
        "v": "ω",
        "b": "β",
        "n": "ν",
        "m": "μ",  
        "Q":":",
        "W":"΅",
        "E":"Ε",
        "R": "Ρ",
        "T": 'Τ',
        "Y": "Υ",
        "U": "Θ",
        "I": "Ι",
        "O": "Ο",
        "P": 'Π', 
        "A": 'Α',
        "S": "Σ",
        "D": 'Δ',
        "F": "Φ",
        "G": "Γ",
        "H": "Η",
        "J": "Ξ",
        "K": "Κ",
        "L": "Λ",
        ":": "¨",
        '"':'"',
        "Z":"Ζ",
        "X":"Χ",
        "C":"Ψ",
        "V": "Ω",
        "B": "Β",
        "N": "Ν",
        "M": "Μ",  
    }
    const layout_EngArab ={ 
        "q":"ض",
        "w":"ص",
        "e":"ث",
        "r": "ق",
        "t": 'ف',
        "y": "غ",
        "u": "ع",
        "i": "ه",
        "o": "خ",
        "p": 'ح',
        "[": 'ج',
        "]": 'د',
        "a": 'ش',
        "s": "س",
        "d": 'ي',
        "f": "ب",
        "g": "ل",
        "h": "ا",
        "j": "ت",
        "k": "ن",
        "l": "م",
        ";": "ك",
        "'":"ط",
        "z":"ئ",
        "x":"ء",
        "c":"ؤ",
        "v": "ر",
        "b": "لا",
        "n": "ى",
        "m": "ة",
        ",": "و",
        ".": "ز",
        "/":"ظ" ,
        "`":"ذ",
        "Q":"َ",
        "W":"ً",
        "E":"ُ",
        "R": "ٌ",
        "T": 'لإ',
        "Y": "إ",
        "U": "‘",
        "I": "÷",
        "O": "×",
        "P": '؛',
        "{": '<',
        "}": '>',
        "A": 'ِ',
        "S": "ٍ",
        "D": ']',
        "F": "[",
        "G": "لأ",
        "H": "أ",
        "J": "ـ",
        "K": "،",
        "L": "/", 
        "Z":"~",
        "X":"ْ",
        "C":"}",
        "V": "{",
        "B": "لآ",
        "N": "آ",
        "M": "’",
        "<": ",",
        ">": ".",
        "?":"؟" ,
        "~":"ّ",
    }
    const layout_EngJap ={ 
        "q":"ﾀ",
        "w":"ﾃ",
        "e":"ｲ",
        "r": "ｽ",
        "t": 'ｶ',
        "y": "ﾝ",
        "u": "ﾅ",
        "i": "ﾆ",
        "o": "ﾗ",
        "p": 'ｾ',
        "[": 'ﾞ',
        "]": 'ﾟ',
        "a": 'ﾁ',
        "s": "ﾄ",
        "d": 'ｼ',
        "f": "ﾊ",
        "g": "ｷ",
        "h": "ｸ",
        "j": "ﾏ",
        "k": "ﾉ",
        "l": "ﾘ",
        ";": "ﾚ",
        "'":"ｹ",
        "\\":"ﾑ",
        "z":"ﾂ",
        "x":"ｻ",
        "c":"ｿ",
        "v": "ﾋ",
        "b": "ｺ",
        "n": "ﾐ",
        "m": "ﾓ",
        ",": "ﾈ",
        ".": "ﾙ",
        "/": "ﾒ" ,
        "`":"ﾛ",
        "Q":"ﾀ",
        "W":"ﾃ",
        "E":"ｨ",
        "R": "ｽ",
        "T": 'ｶ',
        "Y": "ﾝ",
        "U": "ﾅ",
        "I": "ﾆ",
        "O": "ﾗ",
        "P": 'ｾ',
        "{": '｢',
        "}": '｣',
        "A": 'ﾁ',
        "S": "ﾄ",
        "D": 'ｼ',
        "F": "ﾊ",
        "G": "ｷ",
        "H": "ｸ",
        "J": "ﾏ",
        "K": "ﾉ",
        "L": "ﾘ",
        ":": "ﾚ",
        '"':"ｹ",    
        "\\":"ﾑ",
        "Z":"ｯ",
        "X":"ｻ",
        "C":"ｿ",
        "V": "ﾋ",
        "B": "ｺ",
        "N": "ﾐ",
        "M": "ﾓ",
        "<": "､",
        ">": "｡",
        "?":"･" ,
        "~":"ﾛ",
    }
    const layout_EngRus ={ 
        "q":"й",
        "w":"ц",
        "e":"у",
        "r": "к",
        "t": 'е',
        "y": "н",
        "u": "г",
        "i": "ш",
        "o": "щ",
        "p": 'з',
        "[": 'х',
        "]": 'ъ',
        "a": 'ф',
        "s": "ы",
        "d": 'в',
        "f": "а",
        "g": "п",
        "h": "р",
        "j": "о",
        "k": "л",
        "l": "д",
        ";": "ж",
        "'":"э",
        "z":"я",
        "x":"ч",
        "c":"с",
        "v": "м",
        "b": "и",
        "n": "т",
        "m": "ь",
        ",": "б",
        ".": "ю",
        "/":"." ,
        "`":"ё",
        "Q":"Й",
        "W":"Ц",
        "E":"У",
        "R": "К",
        "T": 'Е',
        "Y": "Н",
        "U": "Г",
        "I": "Ш",
        "O": "Щ",
        "P": 'З',
        "{": 'Х',
        "}": 'Ъ',
        "A": 'Ф',
        "S": "Ы",
        "D": 'В',
        "F": "А",
        "G": "П",
        "H": "Р",
        "J": "О",
        "K": "Л",
        "L": "Д",
        ":": "Ж",
        '"':"Э",
        "Z":"Я",
        "X":"Ч",
        "C":"С",
        "V": "М",
        "B": "И",
        "N": "Т",
        "M": "Ь",
        "<": "Б",
        ">": "Ю",
        "?":"," ,
        "~":"Ё",
    } 
    const translate = async (h,elem)=>{
        try {
            if ( ""==h || (typeof h !== 'string')) return;
            let k,t,layout,n_text="";   
            let select = await browser.storage.local.get("s"); 
            switch (select['s']) {
                case "0": 
                    layout=layout_EngUkr;            
                    break;
                case "1": 
                    layout=layout_EngGeo; 
                    break;
                case "2": 
                    layout=layout_EngArm; 
                    break; 
                case "3": 
                    layout=layout_EngHeb; 
                    break;
                case "4": 
                    layout=layout_EngHin; 
                    break;
                case "5": 
                    layout=layout_EngGre; 
                    break;
                case "6": 
                    layout=layout_EngArab; 
                    break;
                case "7": 
                    layout=layout_EngJap; 
                    break;
                case "8": 
                    layout=layout_EngRus; 
                    break;
                default: 
                    alert("Something went wrong. Send message with description of your situation to solobutoalexey@gmail.com");
                    return;             
            } 
            for (let y of h){
                k=false;            
                for(let x of Object.keys(layout)){ 
                    if(x==y){
                        n_text+=layout[x];
                        k=true;
                        break;
                    }
                    if (layout[x]==y){
                        n_text+=x;
                        k=true;
                        break;
                    }
                }
                if (!k) n_text+=y;
            } 
            if (elem.nodeName=="INPUT"){ 
                t=elem.value
                elem.value=t.replace(h,n_text);
            }
            else{ 
                t=elem.innerHTML
                elem.innerHTML=t.replace(h,n_text);
            } 
        } catch (e) {
            console.log(e)
        } 
    } 
browser.runtime.onMessage.addListener( (msg) => {
    translate(msg.highlight,browser.menus.getTargetElement(msg.eId) );
    return Promise.resolve({ response: "c" });     
});}
